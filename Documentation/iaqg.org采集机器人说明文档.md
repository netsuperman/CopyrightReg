# iaqg.org采集机器人说明文档

## 定义
* 从网站获取的**供应商列表**：
> \Data\Temp\SuppliersListUpdate.xlsx

* 待处理**任务队列**：
> \Data\Input\SuppliersQueue.xlsx

* 采集详情后输出的**供应商联络簿**：
> \Data\Output\SuppliersBook.xlsx

## 首次机器人运行流程：
>1. 登录网页；
>1. 选取China类目，每页呈现200条结果，进行搜索；
>1. 逐页采集搜索结果，整理形成**供应商列表**，包含以下字段：
>      OIN
>      Supplier
>      Location
>      Country
>      Status_
>      Standard
>      Cert Num
>      CB
>      Structure Type
>1. 将完整**供应商列表**，作为**任务队列**；
>1. 逐一采集供应商详情，增加以下字段：
>      Specific Standard
>      ExpireDate
>      Contact
>      Phone
>      Email
>      Scope
>1. 完成全部供应商队列采集，形成**供应商联络簿**

## 日常机器人运行流程：
>1. 登录网页；
>1. 检测存在**供应商联络簿**；（不存在则进行首次机器人运行流程）
>1. 检测是否存在**供应商列表**  
>如存在则检测是否为当日生成，  
>如不存在或不为当日生成，则进行采集；  
>（确保供应商列表当日最新且当日只采集一次，手动删除供应商列表，则强制重新采集）
>1. 比对**供应商联络簿**与**供应商列表**，以**供应商列表** 中新增的条目生成**任务队列**;
>1. 查找**供应商联络簿**中**ExpireDate < 当前日期**的条目，添加入**任务队列**;
>1. 执行**任务队列**，形成新**供应商联络簿**